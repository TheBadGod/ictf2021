# Fewer Thoughts, Head Emptier

## Task

There's a beautiful solution for No Thoughts, Head Empty, to make the code just print the flag. However, there's a much easier, but much less elegant solution, that I imagine many people found instead. The elegant solution is still there - can you find it in this empty head?

```
[]>>>>+++++++++++[<+++++++++++>-]--[<-------->+]>+++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++[<+++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++>-]-------[<---------------->+]>+++++
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]--[<------------
----------------------------------------------->+]>+++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]-[<->+]>++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]-----[<----------
---------->+]>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++>-]-[<-->+]>++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]--[<-------------------
---------------------------------------------------------------->+]>++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<+++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]------[<---------
---------->+]>++++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++
++++++++++++>-]-[<----------------------->+]>+++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++>-]---[<------------------------------->+]>++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++[<++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]-------[<--
------------------->+]>++++++++++++++++++++++++++++++++++++++[<+++++++++++++++++
+++++++++++++++++++++>-]-[<--->+]>++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++>-]-[<->+]>+++++++++++++++++++++++++++++
+++++++++++[<++++++++++++++++++++++++++++++++++++++++>-]--[<--------------------
----------------->+]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++[<++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+>-]-----[<----------------->+]>++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++>-]--[<-------------------------------
---------------------------------------------------->+]>++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++[<+++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++>-]---------[<------------->+]>+
+++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++>-]-[<-
-->+]>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++[<++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++>-]-----[<---------->+]>++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++>-]--[<-------->+]>+++++++++++++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++>-]--[<--------------------------------
----------------------------->+]>+++++++++++++++++++++++++++++++++[<++++++++++++
+++++++++++++++++++++>-]---[<---------------->+]>+++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++[<+++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++++>-]---[<------->+]>+++++++++++++++++++++++++++++++++[
<+++++++++++++++++++++++++++++++++>-]---[<------------->+]>+++++++++++++++++++++
++++++++++++++++++++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++++++++++>-]--[<----------------------
---------->+]>++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+++++++[<+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++>-]-[<------------------------------------------------------------------------
----------->+]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++[<+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++>-]-[
<-------------------------------------------------------------------------------
------------------------>+]>++++++++++++++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++[<+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++>-]-[<--------------------------------------------------------------
----------------------------------------------------------------------------->+]
>++++++++++++++++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++>
-]-[<-->+]>+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++>-]-[<-->+]>+++++++++++++++++++++++++++++++++++++++++++++++++
++++++++++++++++++++++++[<++++++++++++++++++++++++++++++++++++++++++++++++++++++
+++++++++++++++++++>-]---[<-------------------------------->+]>+++++++++++++++++
+++++++++++++++++++++++++++++++++++++++++++[<+++++++++++++++++++++++++++++++++++
+++++++++++++++++++++++++>-]---[<------------------------>+]>>++++++[<++++++>-]-
-[<-->+]+<[>[->+>++<<]>>[-<<+>>]<[[<]<[<]>.[>]>[>]<-][<]<[<]<[<]>[-<+<+>>]<<[->>
+<<]>>[<[->>-<<]>-[-<+<+>>]<<[->>+<<]>>]>>[>]>-]
```

## Solution

Oh no, they figured out I used an unintended solution....

But at least I know I just have to modify one character. I noticed
that each characters gets printed double the amount of the previous one,
so we have a doubling function somewhere in there. I thought that it can't
be in any of the setup code, except if it were in the very beginning (Since
every character gets doubled). So I went for the last loop:

`[>[->+>++<<]>>[-<<+>>]<[[<]<[<]>.[>]>[>]<-][<]<[<]<[<]>[-<+<+>>]<<[->>+<<]>>[<[->>-<<]>-[-<+<+>>]<<[->>+<<]>>]>>[>]>-]`

and saw that the very first loop in that loop copies a value but also doubling
it. What happens if I try to remove one of those two pluses?

`ictf{th3_l3s5_th0ugh+_+he_b3teR}`


## Alternative solution

These are the the last loops of the first and second challenge respectively:

`[>[->+>++<<]>>[-<<+>>]<[[<]<[<]>.[>]>[>]<-][<]<[<]<[<]>[-]>[>]>-]`
`[>[->+>++<<]>>[-<<+>>]<[[<]<[<]>.[>]>[>]<-][<]<[<]<[<]>[-<+<+>>]<<[->>+<<]>>[<[->>-<<]>-[-<+<+>>]<<[->>+<<]>>]>>[>]>-]`

we see that the diff is just that `[-]>[>]>-]` got replaced by
`[-<+<+>>]<<[->>+<<]>>[<[->>-<<]>-[-<+<+>>]<<[->>+<<]>>]>>[>]>-]`.

```
[-<+<+>>]           # duplicate the value at the current cell to the left twice
<<[->>+<<]>>        # move the value back from x-2 to x, mem[x] = mem[x-2]; mem[x-2] = 0
[<                  # do mem[x] times:
    [->>-<<]            # subtract the value from the current cell x from the cell x+2
    >-[-<+<+>>]         # subtract one from x, then move the value into the two cells to the left again
    <<[->>+<<]>>        # copy the value back to the current cell
]>>                 # back to the x we started at 
[>]                 # go to the null terminator
>-]`                # end of loop
```

the inner loop seems calculate the sum of the values from the current char to 0,
so according to gauss that would just be x(x+1)//2

So this is responsible for calculating the next character after we printed one. 
If we remove the loop and dump the memory we get

```
0000:  00000000  00000000  00000000  00000069  ...i
0004:  00001620  000013CA  00001AE8  00001500  ....
0008:  00001E3E  00001AEA  00001587  0000058D  ....
000C:  0000123C  00001731  000005A1  00001A43  ....
0010:  000005F6  00001244  00001AEA  00001584  ....
0014:  0000050D  00001B5E  00001554  0000157F  ....
0018:  00000411  000011FB  0000041A  000015B9  ....
001C:  0000147E  00001232  00001326  000005A2  ....
0020:  00001AE7  00001471  00000DC8  00000000  ....
0024:  00000020  00000001                      ..
```

So we can just calculate the next char by doing
`next_char = next_value - (cur_char*(cur_char)+1) // 2`

or in a full script:

```python
values=[105, 5664, 5066, 6888, 5376, 7742, 6890, 5511, 1421, 4668, 5937, 1441, 6723, 1526, 4676, 6890, 5508, 1293, 7006, 5460, 5503, 1041, 4603, 1050, 5561, 5246, 4658, 4902, 1442, 6887, 5233, 3528]
cur_value = 0
flag = ""
for v in values:
    new = values[0] - (cur_value*(cur_value+1))//2
    flag += chr(new)
    cur_value = new
    values = values[1:]
print(flag)
```

which also gives us the flag, a little bit more thoughts, but reversing
brainfuck is just too much fun.
